<!-- Use built-in left arrow for visuals, but disable default navigateBack via delta=0.
     Click handling is implemented via a fixed hot area to avoid navbar event binding issues in some environments. -->
<t-navbar title="{{navbarTitle}}" left-arrow delta="{{0}}" />
<view class="lb-call-back-hotarea" catchtap="onTapBack" />

<view class="page call">
  <!-- Video call UI -->
  <block wx:if="{{mediaType === 'video' && status === 'in_call'}}">
    <!-- Remote video (full screen background) -->
    <canvas type="2d" id="remoteVideo" class="video-remote"></canvas>

    <!-- Local video (small preview) -->
    <camera class="video-local" device-position="front" flash="off" binderror="onCameraError"></camera>
  </block>

  <!-- Voice call / waiting UI -->
  <block wx:else>
    <view class="call__title">{{peerDisplayName || '通话'}}</view>
    <view class="call__status">{{statusText}}</view>
  </block>

  <view class="call__actions {{mediaType === 'video' && status === 'in_call' ? 'call__actions--video' : ''}}">
    <t-button wx:if="{{showAccept}}" theme="primary" shape="round" content="接听" bind:tap="onTapAccept" />
    <t-button wx:if="{{showReject}}" theme="danger" shape="round" content="拒绝" bind:tap="onTapReject" />
    <t-button wx:if="{{showCancel}}" theme="default" variant="outline" shape="round" content="取消" bind:tap="onTapCancel" />
    <t-button wx:if="{{showHangup}}" theme="danger" shape="round" content="挂断" bind:tap="onTapHangup" />
  </view>
</view>
